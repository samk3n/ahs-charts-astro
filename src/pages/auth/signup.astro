---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { Image } from "astro:assets";
import hero from "@/assets/hero6.webp";

const errMsg = Astro.url.searchParams.get("e")
    ? decodeURIComponent(Astro.url.searchParams.get("e")!)
    : null;
---

<BaseLayout
    title="Sign up â€” Rate AHS"
    description="Create an account to rate every AHS season."
>
    <section
        class="relative h-96 flex flex-col items-center justify-center overflow-hidden py-24 text-center text-white"
    >
        <Image
            src={hero}
            alt=""
            class="absolute inset-0 h-full w-full object-cover object-center brightness-60 md:brightness-50"
            loading="lazy"
        />
        <div class="relative z-10 max-w-3xl px-4">
            <h1 class="mb-1 text-3xl tracking-wide font-display">
                Join the cult
            </h1>
            <p class="max-w-[720px] text-muted">
                Sign up with email and password, or use Google.
            </p>
        </div>
    </section>

    <section class="container py-6">
        <div
            class="mx-auto max-w-md rounded-xl border border-border bg-panel p-5"
        >
            {
                errMsg && (
                    <div class="mb-3 rounded-lg border border-border bg-bg/50 p-3 text-sm text-red-500">
                        {errMsg}
                    </div>
                )
            }

            <a
                href="/api/oauth/google"
                class="block w-full rounded-lg border border-border bg-bg px-3 py-2 font-semibold text-center hover:bg-panel/80"
            >
                Continue with Google
            </a>

            <div class="my-4 text-center text-muted">or</div>

            <form action="/api/signup" method="post" class="space-y-3">
                <label class="block">
                    <div class="mb-1 text-sm text-muted">Email</div>
                    <input
                        name="email"
                        type="email"
                        required
                        autocomplete="email"
                        class="w-full rounded-lg border border-border bg-bg px-3 py-2 outline-none focus:ring-2 focus:ring-accent"
                    />
                </label>

                <label class="block">
                    <div class="mb-1 text-sm text-muted">Password</div>
                    <input
                        name="password"
                        type="password"
                        required
                        autocomplete="new-password"
                        class="w-full rounded-lg border border-border bg-bg px-3 py-2 outline-none focus:ring-2 focus:ring-accent"
                    />
                </label>

                <button
                    class="w-full rounded-lg border border-border bg-panel px-3 py-2 font-medium hover:bg-panel/80 cursor-pointer"
                >
                    Sign up
                </button>
            </form>

            <div class="mt-4 text-center text-sm text-muted">
                Already have an account? <a
                    class="text-text underline"
                    href="/auth/login">Log in</a
                >
            </div>
        </div>
    </section>
</BaseLayout>
